---
title: "Problema 2 - Sergio Rivadulla, Jaume Maimó i Àngela Martí "
subtitle: "20582- Análisis de Datos para el GMAT"
format:
  html:
    theme: lumen
    toc: true
    toc-depth: 3
    embed-resources: true
editor: 
  markdown: 
    wrap: sentence
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

```{r, echo=FALSE, include=FALSE}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(GGally)
library(Hotelling)
library(MASS)
library(readr)
library(tidyr)
library(factoextra)
library(ggfortify)
library(MVA)
library(vegan)
```

# Problema 2

**El metabolisme es caracteritza per reaccions químiques vinculades entre si, creant una complexa estructura de xarxa. Una representació simplificada del metabolisme, que anomenem xarxa metabòlica abstracta, és un graf en què les vies metabòliques són nodes i hi ha una aresta entre dos nodes si les corresponents vies comparteixen un o més compostos.**

**Per explorar els potencials i els límits d'una representació tan bàsica, hem fet servir tres tipus de kernels (distàncies entre grafs):**

-   **VH (Vertex histogram): només té en compte si les etiquetes dels nodes dels grafs que es comparen són iguals o no.**

-   **SP (Shortest-Path): compara els grafs en funció dels camins més curts. Intuïtivament, això significa mesurar com és de fàcil o difícil connectar, a través de compostos compartits, parelles de camins en els dos grafs.**

-   **PM (Pyramid Match): mesura la similitud de les característiques topològiques (per exemple, la connectivitat) dels nodes amb la mateixa etiqueta als dos grafs comparats.**

**La pràctica consisteix a representar gràficament (amb només 2 coordenades principals) les matrius de similitud generades per cada nucli pintant els punts d'acord amb el grup d'animals d'acord amb el seu phylum.**

```{r}
phylum <- read.csv("Datos para el ejercicio 2 de la práctica 6 (ACP y MDS)-20241213/fileListANIMAL_phylum.txt", header = F)

VH <- read.table("Datos para el ejercicio 2 de la práctica 6 (ACP y MDS)-20241213/ANIMALS-matrixVH.txt")
VH <- VH %>% as.matrix()

SP <- read.table("Datos para el ejercicio 2 de la práctica 6 (ACP y MDS)-20241213/ANIMALS-matrixSP.txt")
SP <- SP %>% as.matrix()

PM <- read.table("Datos para el ejercicio 2 de la práctica 6 (ACP y MDS)-20241213/ANIMALS-matrixPM.txt")
PM <- PM %>% as.matrix()

```

```{r}
mds1 <- isoMDS(VH)
puntos <- mds1$points
mds <- as_tibble(puntos)
mds
colnames(mds) <- c("Dim1","Dim2")
# Plot MDS
ggscatter(mds, x = "Dim.1", y = "Dim.2",
          size = 1,
          repel = TRUE)
```


Les tres matrius són de similituds, per tant, haurem de realitzar un *MDS no mètric*

```{r}
mds1 <- cmdscale(1-VH, k=2)
plot(mds1)
M <- metaMDS(VH, k=2)
stressplot(M)
M$stress
1-VH
VH
```

```{r}
MDS <- isoMDS(VH, k=2)
MDS
```


